Here's your **text-based program flow** starting from `TestAgenticRAG.py` â€” showing exactly how control flows through your Agentic-RAG system:

---

### ğŸ”„ **PROGRAM FLOW: Agentic-RAG (Textual Trace)**

#### ğŸ“ Entry Point:

**`TestAgenticRAG.py`**

You call:

```python
run_master_agent(input_data=..., is_file=..., llm_type=..., temperature=..., debug=True)
```

---

### ğŸ§  Step 1: Master Agent Dispatch

**File: `master_rag_agent.py`**

```python
if is_file:
    â†’ calls `store_document(...)`
else:
    â†’ calls `retrieve_answer(...)`
```

---

### ğŸ“¥ STORE PATH

#### ğŸ§¾ `store_pipeline.py`

1. Loads file using:
   â†’ `load_file(filepath)` â† from `universal_loader.py`
2. Chunks and classifies each chunk:
   â†’ `classify_text()` â† from `llm_wrapper.py`
3. Routes tag to index:
   â†’ `get_index_for_tag()` â† from `index_router.py`
4. Embeds chunks:
   â†’ Uses `OpenAIEmbeddings` + Pinecone
5. Logs metadata:
   â†’ `log_store_event()` â† from `store_logger.py`

#### ğŸ” Logs Stored:

**Table:** `rag_store_logs`

---

### ğŸ” RETRIEVE PATH

#### ğŸ’¬ `retrieve_pipeline.py`

1. Classifies query:
   â†’ `classify_text()` â† from `llm_wrapper.py`
2. Routes tag to index:
   â†’ `get_index_for_tag()` â† from `index_router.py`
3. Retrieves chunks from Pinecone
4. Synthesizes final answer with LLM:
   â†’ `get_llm()` â† from `llm_wrapper.py`
5. Logs query + response:
   â†’ `log_retrieve_event()` â† from `retrieve_logger.py`

#### ğŸ” Logs Stored:

**Table:** `rag_retrieve_logs`

---

### ğŸ“¦ CONFIG + SUPPORT MODULES

| Module                  | Role                          |
| ----------------------- | ----------------------------- |
| `vector_db_config.json` | Maps tags to Pinecone indexes |
| `utils.py`              | Debug log printer             |
| `llm_wrapper.py`        | Unified LLM interface         |
| `universal_loader.py`   | File format-aware loader      |

---

### ğŸ§ª Final Output:

* Printed final answer
* Printed top 5 retrieved chunk previews
* Metadata logs written to Supabase

---

Would you like this visualized as a **diagram** next or exported as a Markdown/Word file?
